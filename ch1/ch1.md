# Ch1 构造过程抽象

## 1.1 程序设计的基本元素

### 1.1

1. 10
2. 12
3. 8
4. 3
5. 6
6. 3
7. 4
8. 19
9. #f
10. 4
11. 16
12. 6
13. 16

### 1.4

如果 b 大于 0 就执行 a + b，否则就执行 a - b，实际上等价于 a 加上 b 的绝对值。

```scheme
(define (a-plus-abs-b a b)
  (+ a (abs b))
)
```

### 1.5

如果是应用序的话，对 test 表达式求值时先要对 p 表达式求值，但是 p 表达式是递归定义的，所以会无限递归。实际上由于大部分 scheme 解释器是应用序的，所以可以直接运行这段代码来验证。

*在大部分编程语言里，对 p 求值的时候并不会替换为 p，而是报变量未定义的错误*。

如果是正则序的话：

```scheme
(test 0 (p)) ; 展开

((if (= 0 0) 0 y))
```

直接返回 0 不会报错，因为 if 的短路特性没有对 y 求值。

### 1.6

因为在调用 new-if 的时候，我们需要先对所有的子表达式全部求值，这样就会调用 sqrt-iter，然后调用 sqrt-iter 的时候又调用 new-if，所以会无限递归 new-if 和 sqrt-iter。

### 1.7

在处理非常大的数字的时候，计算 good-enough 时有可能发生差永远大于 0.001 的情况导致算法无法中止。

在处理非常小的数字的时候，如果 x 本身就比 0.001 更小，那么做差的时候很快就会中止，导致没有多跑几次迭代，结果当然会不太精确。

## 1.2 过程与它们所产生的计算

### 1.9

对于前者的线性递归过程：

```scheme
(+ 4 5)
(inc (+ 3 5))
(inc (inc (+ 2 5)))
(inc (inc (inc (+ 1 5))))
(inc (inc (inc (inc (+ 0 5)))))
(inc (inc (inc (inc 5))))

; ... 省略几步

(inc 8)
9
```

可以看到运算过程中的信息部分是被解释器维持着（即 inc 的数量）。

对于后者的线性迭代过程：

```scheme
(+ 4 5)
(+ 3 6)
(+ 2 7)
(+ 1 8)
(+ 0 9)
9
```

运行过程的全部信息都储存在 a 和 b 两个变量当中。

### 1.10

对于这三个表达式，我们需要将其递归展开：

```scheme
(A 1 10)
(A 0 (A 1 9))
(A 0 (A 0 (A 1 8)))
(A 0 (A 0 (A 0 (A 1 7))))

; ... 省略

(A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 1)))))))))

(A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 2))))))))
(A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 4)))))))

; ... 省略

1024
```

所以第一个式子的含义实际上是 2 的 10 次方。

```scheme
(A 2 4)
(A 1 (A 2 3))
(A 1 (A 1 (A 2 2)))
(A 1 (A 1 (A 1 (A 2 1))))
(A 1 (A 1 (A 1 2))) 
(A 1 (A 1 4))
(A 1 16) ; 用上面的结论 
65536
```

```scheme
(A 3 3)
(A 2 (A 3 2))
(A 2 (A 2 (A 3 1)))
(A 2 (A 2 2)) 
(A 2 (A 1 (A 2 1)))
(A 2 (A 1 2))
(A 2 (A 0 (A 1 1)))
(A 2 (A 0 2))
(A 2 4) ; 用上面的结论
65536 
```

不难看出：

1. `(define (f n) (A 0 n))` 等价于 $2n$
1. `(define (g n) (A 1 n))` 等价于 $2^n$
1. `(define (h n) (A 2 n))` 这个比较难以一眼看出，我们展开 (A 2 5) 试试

```scheme
(A 2 5)
(A 1 (A 2 4))
(A 1 65536) 
```

可以看到，就是 $2^{(A\ 2\ 4)}$。归纳一下，就是 $2^{2^{2^{2^{...}}}}$，$n$ 为多少就是计算所少次幂。

给自己增加点难度，`(define (l n) (A 3 n)` 对应的数学定义是什么？我们展开 (A 3 4) 试试

```scheme
(A 3 4)
(A 2 (A 3 3))
(A 2 65536)
```

2 上面是 65536 个 2...。可以看出是一个疯狂的套娃，不太好写出通项公式了，实际上，wiki 百科上对于这种情况也是使用了递推公式来表示的，那我们就不为难自己了。











